---
description: "DocumentCreator: 自動作成されたファイルをクリアするコマンド"
---

# あなたの役割

あなたは「出力ファイルクリアコマンド」です。
ユーザーが選択したドキュメント種別の `docs/<doc_type>/output` ディレクトリ内のファイルを安全に削除します。

---

## 1. サポートするドキュメント種別

**詳細は以下のレジストリファイルを参照：**

@.claude/registry/document_types.md

### doc_type の指定方法

`doc_type` は、**コマンド実行後に対話的に確認**します：

1. **対話的選択**（必須）
   - コマンド実行後、ユーザーに利用可能なドキュメント種別を番号付きリストで提示します
   - ユーザーは番号（1-5）または `all` で選択します
   - この方式により、ユーザーは正確にクリア対象を指定できます

### クイックリファレンス

現在サポートしているドキュメント種別（詳細はレジストリ参照）：

| 番号 | doc_type ID | 説明 |
|-----|------------|------|
| 1 | `proposal` | 提案書 |
| 2 | `plan` | 計画書 |
| 3 | `requirement` | 要件定義書 |
| 4 | `to-be_workflow` | To-Beワークフロー / 業務フロー |
| 5 | `spec` | 機能仕様書 / システム仕様書 |

※ 新しいドキュメント種別を追加するときは、レジストリファイルを更新してください。

---

## 2. 対話フロー

以下の手順でクリア処理を実行してください。

### 1. ドキュメント種別 (doc_type) の選択

コマンド実行後、まず以下の形式でユーザーにドキュメント種別を選択してもらいます：

```
クリア対象のドキュメント種別を選択してください：

1. 提案書 (doc_type: proposal)
2. 計画書 (doc_type: plan)
3. 要件定義書 (doc_type: requirement)
4. To-Beワークフロー (doc_type: to-be_workflow)
5. 機能仕様書 (doc_type: spec)
all. すべてのドキュメント種別 (上記すべての output ディレクトリ)

番号 (1-5) または 'all' を入力してください：
```

* ユーザーが番号（1-5）で回答した場合：
  * 対応する `doc_type` を決定します：
    * 1 → `proposal` → `docs/01_proposal/output`
    * 2 → `plan` → `docs/02_plan/output`
    * 3 → `requirement` → `docs/03_requirement/output`
    * 4 → `to-be_workflow` → `docs/04_to-be_workflow/output`
    * 5 → `spec` → `docs/05_spec/output`

* ユーザーが `all` で回答した場合：
  * レジストリに定義されているすべてのドキュメント種別の `output` ディレクトリを対象とします

* **無効な入力の場合**：
  * 1-5 以外の数値や `all` 以外の文字列が入力された場合は、エラーメッセージを表示して再度選択を促してください

### 2. 削除対象の確認

選択後、削除対象のディレクトリ一覧を表示し、確認を求めます：

```
以下の output ディレクトリの内容を削除します：
  - docs/01_proposal/output
  - docs/02_plan/output
  ...

本当に削除してよろしいですか？ (yes/no):
```

* ユーザーが `yes` と回答した場合のみ削除を実行します
* `no` またはそれ以外を入力した場合は、処理をキャンセルして終了します

### 3. 削除処理の実行

確認後、以下の手順で削除を実行します：

1. **対象ディレクトリの存在確認**
   * 各 `docs/<ディレクトリ>/output` ディレクトリが存在するか確認します
   * 存在しない場合は警告メッセージを表示しますが、処理は継続します

2. **削除処理**
   * `docs/<ディレクトリ>/output` ディレクトリ内の**すべてのファイルとサブディレクトリ**を削除します
   * **重要**: `output` ディレクトリ自体は削除しません（ディレクトリは残します）
   * 削除対象には以下が含まれます：
     * `draft/` サブディレクトリとその中身（`draft-*.md`, `eval-*.md` など）
     * 最終版ファイル（`<filename>_<YYYYMMDD>.md` など）

3. **削除結果の報告**
   * 削除が完了したら、ユーザーに結果を報告します：
     * 削除したディレクトリの一覧
     * 存在しなかったディレクトリの一覧（あれば）

---

## 3. 注意事項

### 削除対象の範囲

* **削除するもの**：
  * `docs/<doc_type>/output/` ディレクトリ内のすべてのファイルとサブディレクトリ
  * 例: `draft/` サブディレクトリ、最終版ファイル（`*.md`）など

* **削除しないもの**：
  * `docs/<doc_type>/output/` ディレクトリ自体（空のディレクトリとして残します）
  * `docs/<doc_type>/definitions/` 配下のファイル（テンプレートや評価基準）
  * `docs/00_inputs/` 配下のファイル

### 安全性の確保

* **必ず確認プロンプトを表示**してから削除を実行します
* ユーザーが明示的に `yes` と入力しない限り、削除を実行しません
* 削除前に削除対象の一覧を明確に表示します

### エラーハンドリング

* 存在しないディレクトリに対しては警告を表示しますが、処理は継続します
* 削除に失敗した場合は、エラーメッセージを表示して処理を中断します

---

## 4. 実装の詳細

### レジストリファイルの読み込み

* `.claude/registry/document_types.md` を読み込んで、ドキュメント種別の一覧を取得します
* レジストリファイルのテーブルから、番号、doc_type、表示名、ディレクトリ名を抽出します

### ディレクトリパスの構築

* レジストリから取得したディレクトリ名（例: `01_proposal`）を使用して、`docs/<ディレクトリ>/output` のパスを構築します

### 削除処理の実装

削除処理は以下の手順で実行します：

1. **ディレクトリ内容の取得**
   * `list_dir` ツールで `docs/<doc_type>/output` の内容を確認します
   * 取得したファイルとディレクトリの一覧を保持します

2. **ファイルの削除**
   * `output` ディレクトリ直下の各ファイル（`*.md` など）に対して、`delete_file` ツールを使用して削除します

3. **サブディレクトリの処理**
   * サブディレクトリ（`draft/` など）が存在する場合：
     * `list_dir` ツールでサブディレクトリの中身を再帰的に取得します
     * サブディレクトリ内の各ファイルに対して、`delete_file` ツールを使用して削除します
     * すべてのファイルを削除した後、空になったサブディレクトリ内のファイルも削除します

4. **削除の確認**
   * 削除後、再度 `list_dir` ツールで `output` ディレクトリの内容を確認し、空になっていることを確認します

**重要**: 
* `output` ディレクトリ自体は削除せず、中身のみを削除してください
* ディレクトリが空の場合は、そのまま残します
* 削除に失敗したファイルがある場合は、エラーメッセージを表示して処理を継続します

